<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>CraftNet Ultimate</title>
<link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&family=VT323&display=swap" rel="stylesheet">

<style>
:root{
--bg:#1e1e1e;--panel:#333;--green:#5da03b;--admin:#b04bff;
}
body{margin:0;font-family:VT323;background:var(--bg);color:white}
.hidden{display:none}
header{background:#866043;border-bottom:4px solid #000;padding:10px 20px;display:flex;justify-content:space-between}
.avatar{width:48px;height:48px;border:2px solid #000}
.container{max-width:700px;margin:20px auto;padding:0 10px}

.post{background:var(--panel);border:3px solid #000;margin-bottom:20px}
.post-header{background:#444;padding:10px;display:flex;gap:10px;align-items:center}
.post-body{padding:15px;font-size:1.5rem}
.post-footer{background:#222;padding:10px;display:flex;gap:15px}
.admin{background:var(--admin);padding:2px 6px;border:2px solid #000;font-size:.7rem}

.profile{background:#444;border:3px solid #000;padding:20px;text-align:center}
.profile img{width:96px;border:3px solid #000}
.stats{display:flex;justify-content:space-around;margin:10px 0}

.btn{padding:8px;border:2px solid #000;background:#aaa;cursor:pointer;font-family:'Press Start 2P';font-size:.6rem}
.btn-green{background:var(--green);color:white}
.chat{background:#111;border:3px solid #000;padding:10px;height:250px;overflow-y:auto}
.msg{margin:4px 0}
input,textarea{width:100%;padding:8px;margin:6px 0;background:#000;color:#3f3;border:2px solid #555;font-family:VT323}

.modal{position:fixed;inset:0;background:rgba(0,0,0,.95);display:flex;align-items:center;justify-content:center}
.card{background:#888;border:4px solid #000;padding:20px;width:340px;text-align:center}
</style>
</head>

<body>

<!-- LOGIN -->
<div id="auth" class="modal">
<div class="card">
<h3>LOGIN</h3>
<input id="user" placeholder="Name">
<input id="pass" type="password" placeholder="Passwort">
<button class="btn btn-green" onclick="login()">LOGIN</button>
</div>
</div>

<header>
<div>CRAFTNET</div>
<div id="nav"></div>
</header>

<div class="container hidden" id="main">
<textarea id="postText" placeholder="Post..."></textarea>
<button class="btn btn-green" onclick="createPost()">POST</button>
<div id="feed"></div>
</div>

<script>
const ADMIN="Mauvi_";
let users=JSON.parse(localStorage.users||"{}");
let posts=JSON.parse(localStorage.posts||"[]");
let chats=JSON.parse(localStorage.chats||"{}");
let me=null;

function save(){
localStorage.users=JSON.stringify(users);
localStorage.posts=JSON.stringify(posts);
localStorage.chats=JSON.stringify(chats);
}

function login(){
let u=user.value;
let p=pass.value;
if(!users[u])users[u]={pass:p,skin:`https://minotar.net/avatar/${u}`,bio:"",status:"",friends:[]};
if(users[u].pass!==p)return alert("Falsch");
me=u;
auth.classList.add("hidden");
main.classList.remove("hidden");
nav.innerHTML=u+(u===ADMIN?" <span class='admin'>ADMIN</span>":"");
renderFeed();
}

function createPost(){
posts.unshift({id:Date.now(),author:me,text:postText.value,likes:[]});
postText.value="";
save();renderFeed();
}

function renderFeed(){
feed.innerHTML="";
posts.forEach(p=>{
feed.innerHTML+=`
<div class="post">
<div class="post-header">
<img class="avatar" src="${users[p.author].skin}">
<b onclick="profile('${p.author}')">${p.author}</b>
${p.author===ADMIN?'<span class="admin">ADMIN</span>':''}
</div>
<div class="post-body">${p.text}</div>
<div class="post-footer">
<span>‚õè ${p.likes.length}</span>
${me===ADMIN?`<span onclick="delPost(${p.id})">üóë</span>`:""}
</div>
</div>`;
});
}

function delPost(id){
posts=posts.filter(p=>p.id!==id);
save();renderFeed();
}

function profile(u){
let fr=users[u].friends.includes(me);
feed.innerHTML=`
<div class="profile">
<img src="${users[u].skin}">
<h2>${u}</h2>
<p>${users[u].status}</p>
<textarea ${u!==me?"disabled":""} onchange="users[me].bio=this.value;save()">${users[u].bio}</textarea>
${u!==me?`<button class="btn" onclick="friend('${u}')">${fr?"Freund entfernen":"Freund hinzuf√ºgen"}</button>`:""}
${fr?`<button class="btn" onclick="chat('${u}')">CHAT</button>`:""}
<button class="btn" onclick="renderFeed()">‚¨Ö</button>
</div>`;
}

function friend(u){
if(users[u].friends.includes(me)){
users[u].friends=users[u].friends.filter(x=>x!==me);
users[me].friends=users[me].friends.filter(x=>x!==u);
}else{
users[u].friends.push(me);
users[me].friends.push(u);
}
save();profile(u);
}

function chat(u){
let id=[me,u].sort().join("-");
chats[id]=chats[id]||[];
feed.innerHTML=`
<div class="profile">
<h3>Chat mit ${u}</h3>
<div class="chat" id="chatbox">
${chats[id].map(m=>`<div class="msg"><b>${m.u}:</b> ${m.t}</div>`).join("")}
</div>
<input id="msg">
<button class="btn" onclick="send('${id}','${u}')">SEND</button>
<button class="btn" onclick="profile('${u}')">‚¨Ö</button>
</div>`;
}

function send(id,u){
chats[id].push({u:me,t:msg.value});
msg.value="";
save();chat(u);
}
</script>

</body>
</html>
