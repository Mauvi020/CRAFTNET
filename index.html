<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>CraftNet Ultimate</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&family=VT323&display=swap" rel="stylesheet">
<style>
:root{--bg:#1e1e1e;--panel:#333;--green:#5da03b;--dirt:#866043;--blue:#3498db;--gold:#ffcc00;--red:#e74c3c;}
body{margin:0;background:var(--bg);color:white;font-family:'VT323',monospace;}
.hidden{display:none!important;}
header{background:var(--dirt);border-bottom:4px solid #000;padding:10px 20px;display:flex;justify-content:space-between;align-items:center;position:sticky;top:0;}
.header-title{cursor:pointer;color:#3f3;font-family:'Press Start 2P';font-size:.8rem;}
.container{max-width:700px;margin:20px auto;padding:0 10px;}
.avatar{width:40px;border:2px solid #000;image-rendering:pixelated;}
#side-menu{position:fixed;top:60px;left:0;width:280px;height:calc(100% - 60px);background:#222;border-right:4px solid #000;padding:20px;transform:translateX(-100%);transition:.3s;}
#side-menu.open{transform:translateX(0);}
.menu-item{background:#444;border:2px solid #000;padding:10px;margin-bottom:10px;cursor:pointer;font-family:'Press Start 2P';font-size:.5rem;text-align:center;}
.menu-item:hover{background:var(--green);}
.post{background:var(--panel);border:3px solid #000;margin-bottom:20px;}
.post-header{background:#444;padding:10px;}
.post-body{padding:15px;font-size:1.4rem;word-wrap:break-word;}
.post-footer{background:#222;padding:10px;border-top:1px solid #444;}
.btn{padding:10px;border:2px solid #000;cursor:pointer;font-family:'Press Start 2P';font-size:.5rem;}
.btn-green{background:var(--green);color:white;}
.btn-red{background:var(--red);color:white;}
.btn-blue{background:var(--blue);color:white;}
</style>
</head>

<body>

<header>
    <div class="header-title" id="menu-trigger">â˜° CRAFTNET</div>
</header>

<div id="side-menu">
    <div class="menu-item" onclick="showHome()">ğŸ  HOME</div>
    <div class="menu-item" style="background:var(--blue)" onclick="showMiniGames()">ğŸ® MINI-SPIELE</div>
    <div class="menu-item" style="background:var(--gold);color:black" onclick="openOwner()">ğŸ‘‘ OWNER</div>
</div>

<div id="main" class="container">
    <!-- FEED -->
    <div id="feed">
        <div class="post">
            <div class="post-header"><b>ğŸŒ WILLKOMMEN</b></div>
            <div class="post-body">
                Das ist CraftNet!  
                Poste, chatte mit Freunden und entdecke Mini-Spiele ğŸ®.
            </div>
        </div>
    </div>

    <!-- MINI GAMES -->
    <div id="minigames" class="hidden"></div>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getFirestore, doc, setDoc, getDocs, collection, query, orderBy, limit } 
from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyDxV7vSYCg5MwgakrdEsgWcQF6ZlEyDWkg",
  authDomain: "craftnet-1c6d1.firebaseapp.com",
  projectId: "craftnet-1c6d1"
};
const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

const el = id => document.getElementById(id);
let currentUser = "Gast";

/* MENU TOGGLE */
el("menu-trigger").onclick = () => el("side-menu").classList.toggle("open");

/* ================= HOME ================= */
window.showHome = () => {
    el("feed").classList.remove("hidden");
    el("minigames").classList.add("hidden");
};

/* ================= OWNER ================= */
window.openOwner = () => {
    el("feed").classList.add("hidden");
    el("minigames").classList.remove("hidden");
    el("minigames").innerHTML = `
        <div class="post">
            <div class="post-header"><b>ğŸ‘‘ OWNER</b></div>
            <div class="post-body">Entwickelt von <b>Mauvi_</b><br>CraftNet v2.0</div>
            <div class="post-footer">
                <button class="btn" onclick="showHome()">ğŸ  HOME</button>
            </div>
        </div>
    `;
};

/* ================= MINI-SPIELE ================= */
let miner = { blocks:0, perClick:1 };

window.showMiniGames = () => {
    el("feed").classList.add("hidden");
    el("minigames").classList.remove("hidden");
    el("minigames").innerHTML = `
        <div class="post">
            <div class="post-header"><b>ğŸ® MINI-SPIELE</b></div>
            <div class="post-body">
                <button class="btn btn-green" style="width:100%" onclick="openClickMiner()">â›ï¸ CLICK MINER</button>
                <button class="btn btn-blue" style="width:100%;margin-top:5px" onclick="openLeaderboard()">ğŸ† LEADERBOARD</button>
            </div>
            <div class="post-footer">
                <button class="btn" onclick="showHome()">ğŸ  HOME</button>
            </div>
        </div>
    `;
};

window.openClickMiner = () => {
    el("minigames").innerHTML = `
        <div class="post">
            <div class="post-header"><b>â›ï¸ CLICK MINER</b></div>
            <div class="post-body" style="text-align:center">
                <p>BlÃ¶cke: <b id="bc">${miner.blocks}</b></p>
                <p>Pro Klick: ${miner.perClick}</p>
                <img src="https://static.wikia.nocookie.net/minecraft_gamepedia/images/6/6e/Stone_JE5_BE3.png"
                     style="width:120px;cursor:pointer;border:4px solid #000;image-rendering:pixelated"
                     onclick="mine()">
                <hr>
                <h3>ğŸ›’ SHOP</h3>
                <button class="btn btn-green" style="width:100%" onclick="upgrade()">+1 Block/Klick (Kosten: ${miner.perClick*10})</button>
                <button class="btn btn-blue" style="width:100%;margin-top:5px" onclick="saveScore()">ğŸ’¾ Score speichern</button>
            </div>
            <div class="post-footer">
                <button class="btn" onclick="showMiniGames()">â¬… ZURÃœCK</button>
                <button class="btn" onclick="showHome()">ğŸ  HOME</button>
            </div>
        </div>
    `;
};

window.mine = () => { miner.blocks += miner.perClick; el("bc").innerText = miner.blocks; };
window.upgrade = () => {
    const cost = miner.perClick*10;
    if(miner.blocks < cost) return alert("Nicht genug BlÃ¶cke!");
    miner.blocks -= cost;
    miner.perClick++;
    openClickMiner();
};

/* LEADERBOARD */
window.saveScore = async () => {
    await setDoc(doc(db,"leaderboard",currentUser),{user:currentUser, blocks:miner.blocks});
    alert("Score gespeichert!");
};

window.openLeaderboard = async () => {
    const snap = await getDocs(query(collection(db,"leaderboard"), orderBy("blocks","desc"), limit(10)));
    let list = "";
    let i = 1;
    snap.forEach(d => { list += `<p>${i++}. <b>${d.data().user}</b> â€“ ${d.data().blocks}</p>`; });
    el("minigames").innerHTML = `
        <div class="post">
            <div class="post-header"><b>ğŸ† LEADERBOARD</b></div>
            <div class="post-body">${list || "Noch leer"}</div>
            <div class="post-footer">
                <button class="btn" onclick="showMiniGames()">â¬… ZURÃœCK</button>
                <button class="btn" onclick="showHome()">ğŸ  HOME</button>
            </div>
        </div>
    `;
};
</script>

</body>
</html>
