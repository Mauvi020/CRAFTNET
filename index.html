<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>CraftNet</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&family=VT323&display=swap" rel="stylesheet">
<style>
body{margin:0;background:#1e1e1e;color:white;font-family:'VT323'}
.hidden{display:none}
header{background:#866043;padding:10px 20px;border-bottom:4px solid #000;display:flex;justify-content:space-between}
.header-title{font-family:'Press Start 2P';color:#3f3;cursor:pointer}
.avatar{width:40px;height:40px;border:2px solid #000}
.container{max-width:700px;margin:20px auto;padding:0 10px}
.post{background:#333;border:3px solid #000;margin-bottom:15px;padding:10px}
input,textarea{width:100%;padding:8px;margin:6px 0;background:#000;color:#3f3;border:2px solid #555}
.btn{width:100%;padding:10px;margin-top:8px;font-family:'Press Start 2P';font-size:.6rem;cursor:pointer}
.btn-green{background:#5da03b;color:white}
.modal{position:fixed;inset:0;background:rgba(0,0,0,.95);display:flex;align-items:center;justify-content:center}
.card{background:#888;border:4px solid #000;padding:20px;width:340px;text-align:center}
.error{background:#ffaaaa;color:#900;padding:6px;border:2px solid #000;margin-bottom:6px}
</style>
</head>
<body>

<!-- LOGIN -->
<div id="auth" class="modal">
  <div class="card">
    <h2 style="font-family:'Press Start 2P';font-size:.8rem">LOGIN / REGISTER</h2>
    <div id="error" class="error hidden"></div>
    <input id="user" placeholder="Name">
    <input id="pass" type="password" placeholder="Passwort (min.4)">
    <button class="btn btn-green" onclick="login()">BETRETEN</button>
    <p style="font-size:.7rem">Neuer Name = Auto-Registrierung</p>
  </div>
</div>

<header>
  <div class="header-title" onclick="menu()">CRAFTNET</div>
  <div id="nav" class="hidden">
    <span id="nav-name"></span>
    <img id="nav-img" class="avatar">
  </div>
</header>

<div id="main" class="container hidden">
  <div class="post">
    <textarea id="text" placeholder="Was gibt's Neues?"></textarea>
    <button class="btn btn-green" onclick="post()">POSTEN</button>
  </div>
  <div id="feed"></div>
</div>

<script>
let users=JSON.parse(localStorage.getItem("users")||"{}");
let posts=JSON.parse(localStorage.getItem("posts")||"[]");
let me=null;

const $=id=>document.getElementById(id);
const save=()=>{localStorage.setItem("users",JSON.stringify(users));localStorage.setItem("posts",JSON.stringify(posts));}

function err(m){$("error").innerText=m;$("error").classList.remove("hidden");}

function login(){
  const u=$("user").value.trim();
  const p=$("pass").value;
  if(!u||p.length<4) return err("Name & Passwort nÃ¶tig");

  // ðŸ”¥ AUTO REGISTER
  if(!users[u]){
    users[u]={pass:p,skin:`https://minotar.net/avatar/${u}`};
    save();
  }

  if(users[u].pass!==p) return err("Falsches Passwort");

  me=u;
  $("auth").classList.add("hidden");
  $("main").classList.remove("hidden");
  $("nav").classList.remove("hidden");
  $("nav-name").innerText=u;
  $("nav-img").src=users[u].skin;
  render();
}

function post(){
  const t=$("text").value.trim();
  if(!t) return;
  posts.unshift({u:me,t});
  $("text").value="";
  save();render();
}

function render(){
  $("feed").innerHTML="";
  posts.forEach(p=>{
    $("feed").innerHTML+=`
      <div class="post">
        <b>${p.u}</b><br>${p.t}
      </div>`;
  });
}

function menu(){
  if(!me) return;
  $("feed").innerHTML=`
    <div class="post">
      <button class="btn btn-green" onclick="render()">Feed</button>
      <button class="btn" onclick="logout()">Logout</button>
    </div>`;
}

function logout(){
  me=null;
  $("main").classList.add("hidden");
  $("auth").classList.remove("hidden");
  $("nav").classList.add("hidden");
}
</script>
</body>
</html>
